<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sunset DJ Party | Book Your Spot Now</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Updated to latest EmailJS v4 for better compatibility -->
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
    ></script>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        overflow-x: hidden;
        background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
        color: #e0e0e0;
      }

      .hero-section {
        position: relative;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: white;
        overflow: hidden;
      }

      .hero-video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -2;
      }

      .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          rgba(10, 10, 30, 0.8),
          rgba(20, 20, 50, 0.6)
        );
        z-index: -1;
      }

      .floating-lights {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
      }

      .floating-lights::before,
      .floating-lights::after {
        content: "";
        position: absolute;
        width: 4px;
        height: 4px;
        background: #ffd700;
        border-radius: 50%;
        animation: subtleFloat 8s ease-in-out infinite;
        opacity: 0.7;
        box-shadow: 0 0 20px #ffd700;
      }

      .floating-lights::before {
        top: 30%;
        left: 10%;
        animation-delay: 0s;
      }

      .floating-lights::after {
        top: 70%;
        left: 90%;
        animation-delay: 4s;
      }

      @keyframes subtleFloat {
        0%,
        100% {
          transform: translateY(0) scale(1);
          opacity: 0.5;
        }
        50% {
          transform: translateY(-20px) scale(1.3);
          opacity: 0.9;
        }
      }

      .hero-content {
        z-index: 1;
        position: relative;
      }

      .hero-content h1 {
        font-size: 4rem;
        font-weight: 700;
        margin-bottom: 1rem;
        text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.9);
        color: #ffffff;
        animation: glow 2s ease-in-out infinite alternate;
      }

      @keyframes glow {
        from {
          text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.9),
            0 0 20px rgba(255, 215, 0, 0.3);
        }
        to {
          text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.9),
            0 0 40px rgba(255, 215, 0, 0.6);
        }
      }

      .hero-content p {
        font-size: 1.3rem;
        font-weight: 300;
        margin-bottom: 2rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .countdown {
        font-size: 1.8rem;
        font-weight: 600;
        color: #ffd700;
        text-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        padding: 15px 30px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        display: inline-block;
      }

      .btn-book {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        border: 2px solid #ffd700;
        color: #ffffff !important;
        padding: 15px 40px;
        font-size: 1.2rem;
        font-weight: 600;
        border-radius: 50px;
        transition: all 0.4s ease;
        box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        position: relative;
        overflow: hidden;
        text-decoration: none;
        display: inline-block;
      }

      .btn-book::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }

      .btn-book:hover::before {
        left: 100%;
      }

      .btn-book:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 8px 25px rgba(231, 76, 60, 0.6);
      }

      .section-padding {
        padding: 100px 0;
      }

      .event-details {
        background: linear-gradient(to bottom, #1a1a2e, #16213e);
      }

      .event-details h2 {
        font-size: 2.5rem;
        font-weight: 700;
        color: #ffd700;
        text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
      }

      .detail-card {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        border-radius: 15px;
        padding: 35px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transition: all 0.4s ease;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
      }

      .detail-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, rgba(255, 215, 0, 0.1), transparent);
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      .detail-card:hover::before {
        opacity: 1;
      }

      .detail-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3);
        border-color: #ffd700;
      }

      .detail-card h4 {
        color: #ffd700;
        font-weight: 600;
        margin-bottom: 20px;
      }

      .detail-card i {
        color: #e74c3c;
        font-size: 1.3rem;
      }

      .list-group-item {
        background: rgba(0, 0, 0, 0.2) !important;
        border: 1px solid rgba(255, 215, 0, 0.2);
        color: #e0e0e0 !important;
        padding: 15px;
        margin-bottom: 8px;
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .list-group-item:hover {
        background: rgba(255, 215, 0, 0.1) !important;
        transform: translateX(5px);
      }

      .highlight-value {
        color: #ffd700;
        font-weight: 600;
        font-size: 1.1rem;
      }

      .location-badge {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 8px 15px;
        background: rgba(231, 76, 60, 0.2);
        border: 1px solid #e74c3c;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .location-badge:hover {
        background: rgba(231, 76, 60, 0.4);
        transform: scale(1.05);
      }

      .location-badge i {
        animation: pulse 1.5s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      .feature-icon-box {
        text-align: center;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        margin: 10px;
        transition: all 0.3s ease;
      }

      .feature-icon-box:hover {
        background: rgba(255, 215, 0, 0.1);
        transform: translateY(-5px);
      }

      .feature-icon-box i {
        font-size: 3rem;
        color: #e74c3c;
        margin-bottom: 10px;
      }

      .bg-dark-gradient {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      }

      .booking-form {
        background: rgba(44, 62, 80, 0.95);
        border-radius: 20px;
        padding: 50px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(15px);
        border: 2px solid rgba(255, 215, 0, 0.3);
      }

      .form-label {
        font-weight: 600;
        color: #ffd700;
        margin-bottom: 8px;
      }

      .form-control,
      .form-select {
        border-radius: 10px;
        border: 2px solid #34495e;
        padding: 12px;
        background: #2c3e50;
        color: #e0e0e0;
        transition: all 0.3s ease;
      }

      .form-control:focus,
      .form-select:focus {
        border-color: #ffd700;
        box-shadow: 0 0 0 0.2rem rgba(255, 215, 0, 0.25);
        background: #34495e;
        color: #ffffff;
      }

      .submit-btn {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        border: 2px solid #ffd700;
        color: #ffffff !important;
        padding: 15px 30px;
        font-size: 1.2rem;
        font-weight: 600;
        border-radius: 50px;
        transition: all 0.4s ease;
        box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
      }

      .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(231, 76, 60, 0.6);
        background: linear-gradient(45deg, #c0392b, #e74c3c);
      }

      .contact-info {
        background: rgba(0, 0, 0, 0.3);
        padding: 20px;
        border-radius: 15px;
        border: 1px solid rgba(255, 215, 0, 0.2);
        margin-top: 30px;
      }

      .contact-info a {
        color: #ffd700;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .contact-info a:hover {
        color: #e74c3c;
        text-decoration: underline;
      }

      footer {
        background: linear-gradient(45deg, #0f0f23, #1a1a2e);
        color: #bdc3c7;
        border-top: 2px solid rgba(255, 215, 0, 0.2);
        padding: 30px 0;
      }

      /* New Styles for Confirmation Modals */
      .confirmation-modal .modal-content {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        border: 2px solid #ffd700;
        color: #e0e0e0;
        border-radius: 15px;
      }

      .confirmation-modal .modal-header {
        border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        color: #ffd700;
      }

      .confirmation-modal .modal-body {
        font-size: 1.1rem;
      }

      .confirmation-modal .btn-success {
        background: linear-gradient(45deg, #27ae60, #2ecc71);
        border: none;
        border-radius: 50px;
        padding: 12px 30px;
        font-weight: 600;
      }

      .confirmation-modal .btn-danger {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
        border: none;
        border-radius: 50px;
        padding: 12px 30px;
        font-weight: 600;
      }

      .confirmation-modal .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .success-icon {
        font-size: 4rem;
        color: #27ae60;
        animation: bounce 1s ease-in-out;
      }

      .error-icon {
        font-size: 4rem;
        color: #e74c3c;
        animation: shake 0.5s ease-in-out;
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        10%,
        30%,
        50%,
        70%,
        90% {
          transform: translateX(-5px);
        }
        20%,
        40%,
        60%,
        80% {
          transform: translateX(5px);
        }
      }

      @media (max-width: 768px) {
        .hero-content h1 {
          font-size: 2.5rem;
        }
        .booking-form {
          padding: 30px 20px;
        }
        .countdown {
          font-size: 1.3rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Hero Section -->
    <section class="hero-section">
      <video autoplay muted loop class="hero-video" playsinline>
        <source src="videos/bg.mp4" type="video/mp4" />
      </video>
      <div class="hero-overlay"></div>
      <div class="floating-lights"></div>
      <div class="hero-content" data-aos="fade-down">
        <h1 class="display-3 fw-bold mb-4">ðŸŽŠ Sunset DJ Party ðŸŽŠ</h1>
        <p class="lead mb-4">
          Elevate your Diwali with music, lights, and unforgettable vibes at
          <strong>Jamuna Dighi</strong>.
        </p>
        <div id="countdown" class="countdown mb-4"></div>
        <a href="#booking" class="btn btn-book btn-lg px-5 py-3"
          >Secure Your Invitation</a
        >
      </div>
    </section>

    <!-- Event Executive Summary -->
    <section class="event-details section-padding">
      <div class="container">
        <h2 class="text-center mb-5" data-aos="zoom-in">
          ðŸŽ§ Event Executive Summary
        </h2>

        <div class="row justify-content-center">
          <div class="col-lg-10">
            <!-- Event Info -->
            <div class="detail-card mb-4" data-aos="fade-up">
              <h4 class="mb-3">
                <i class="fas fa-map-marked-alt me-2"></i>Event & Location
              </h4>
              <ul class="list-group">
                <li class="list-group-item">
                  <i class="fas fa-music me-2"></i>
                  <strong>Event:</strong>
                  <span class="highlight-value">Sunset DJ Party 2025</span>
                </li>
                <li class="list-group-item">
                  <i class="fas fa-calendar-alt me-2"></i>
                  <strong>Date & Time:</strong>
                  <span class="highlight-value"
                    >Sat, 18 Oct 2025 â€“ 11:00 AM Onwards</span
                  >
                </li>
                <li class="list-group-item">
                  <i class="fas fa-map-pin me-2"></i>
                  <strong>Location:</strong>
                  <span class="location-badge ms-2" id="locationLink">
                    <i class="fas fa-location-arrow"></i>
                    <span>Jamuna Dighi, Pin: 713403</span>
                    <i class="fas fa-external-link-alt"></i>
                  </span>
                </li>
                <li class="list-group-item">
                  <i class="fas fa-palette me-2"></i>
                  <strong>Theme:</strong>
                  <span class="highlight-value"
                    >Ethnic meets Modern â€“ Diwali Edition</span
                  >
                </li>
              </ul>
            </div>

            <!-- Investment & Entry -->
            <div
              class="detail-card mb-4"
              data-aos="fade-up"
              data-aos-delay="100"
            >
              <h4 class="mb-3">
                <i class="fas fa-ticket-alt me-2"></i>Entry & Investment
              </h4>
              <div class="row text-center">
                <div class="col-md-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-user"></i>
                    <h5 class="mt-2 text-light">Stag Entry</h5>
                    <p class="highlight-value mb-0">â‚¹1299</p>
                    <small class="text-muted">Single Person Access</small>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-user-friends"></i>
                    <h5 class="mt-2 text-light">Couple Entry</h5>
                    <p class="highlight-value mb-0">â‚¹2199</p>
                    <small class="text-muted">Two Person Access</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Culinary -->
            <div
              class="detail-card mb-4"
              data-aos="fade-up"
              data-aos-delay="200"
            >
              <h4 class="mb-3">
                <i class="fas fa-utensils me-2"></i>Premium Food & Drinks
              </h4>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-glass-cheers"></i>
                    <p class="mt-2 mb-0 text-light">Unlimited Mocktails</p>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-fire"></i>
                    <p class="mt-2 mb-0 text-light">Barbecue Starters</p>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-birthday-cake"></i>
                    <p class="mt-2 mb-0 text-light">Diwali Buffet</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Facilities -->
            <div class="detail-card" data-aos="fade-up" data-aos-delay="300">
              <h4 class="mb-3">
                <i class="fas fa-star me-2"></i>Special Facilities
              </h4>
              <div class="row">
                <div class="col-md-3 col-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-headphones"></i>
                    <p class="mt-2 mb-0 text-light">Live DJs</p>
                  </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-camera"></i>
                    <p class="mt-2 mb-0 text-light">Photo Booths</p>
                  </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-gamepad"></i>
                    <p class="mt-2 mb-0 text-light">Fun Games</p>
                  </div>
                </div>
                <div class="col-md-3 col-6 mb-3">
                  <div class="feature-icon-box">
                    <i class="fas fa-wind"></i>
                    <p class="mt-2 mb-0 text-light">Hookah (Limited)</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Booking Section -->
    <section id="booking" class="section-padding bg-dark-gradient">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <h2
              class="text-center mb-5"
              data-aos="zoom-in"
              style="color: #ffd700"
            >
              Claim Your Booking Now
            </h2>
            <form id="bookingForm" class="booking-form">
              <div class="mb-3">
                <label for="name" class="form-label">Full Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  required
                  placeholder="Enter your full name"
                />
              </div>
              <div class="mb-3">
                <label for="email" class="form-label">Email Address</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  required
                  placeholder="your.email@example.com"
                />
              </div>
              <div class="mb-3">
                <label for="phone" class="form-label">Phone Number</label>
                <input
                  type="tel"
                  class="form-control"
                  id="phone"
                  required
                  placeholder="+91 XXXXXXXXXX"
                  pattern="[0-9]{10}"
                />
              </div>
              <div class="mb-3">
                <label for="entryType" class="form-label">Entry Type</label>
                <select class="form-select" id="entryType" required>
                  <option value="">Select your entry type...</option>
                  <option value="stag">Stag Entry â€“ â‚¹1299</option>
                  <option value="couple">Couple Entry â€“ â‚¹2199</option>
                </select>
              </div>
              <button type="submit" class="submit-btn w-100 py-3 fs-5">
                <i class="fas fa-check-circle me-2"></i>Proceed to Payment
              </button>
            </form>

            <div class="contact-info text-center">
              <p class="mb-2 text-light">
                <i class="fas fa-info-circle me-2"></i>Need help with booking?
              </p>
              <p class="mb-2">
                <i class="fas fa-phone-alt me-2"></i>Call:
                <a href="tel:+917318749498">+91 7318749498</a>
              </p>
              <p class="mb-0">
                <i class="fas fa-envelope me-2"></i>Email:
                <a href="mailto:gourangabwn98@gmail.com"
                  >gourangabwn98@gmail.com</a
                >
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Success Confirmation Modal -->
    <div
      class="modal fade confirmation-modal"
      id="successModal"
      tabindex="-1"
      aria-labelledby="successModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title w-100" id="successModalLabel">
              <i class="fas fa-check-circle success-icon"></i>
              <br />Payment Successful!
            </h5>
          </div>
          <div class="modal-body text-center">
            <p>
              Thank you for your booking! Your invitation to the Sunset DJ Party
              is confirmed.
            </p>
            <div id="successDetails" class="mb-3"></div>
            <p>
              A detailed confirmation email has been sent to your registered
              email address. Please check your inbox (and spam folder if
              needed).
            </p>
            <p>
              If you don't receive it within 5 minutes, contact us at
              <a href="mailto:gourangabwn98@gmail.com"
                >gourangabwn98@gmail.com</a
              >.
            </p>
          </div>
          <div class="modal-footer justify-content-center">
            <button
              type="button"
              class="btn btn-success"
              data-bs-dismiss="modal"
            >
              Close & Return to Home
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Confirmation Modal -->
    <div
      class="modal fade confirmation-modal"
      id="errorModal"
      tabindex="-1"
      aria-labelledby="errorModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title w-100" id="errorModalLabel">
              <i class="fas fa-times-circle error-icon"></i>
              <br />Payment Failed
            </h5>
          </div>
          <div class="modal-body text-center">
            <p>
              We're sorry, but your payment could not be processed at this time.
            </p>
            <p>Please try again or contact our support team for assistance.</p>
          </div>
          <div class="modal-footer justify-content-center">
            <button
              type="button"
              class="btn btn-danger"
              data-bs-dismiss="modal"
            >
              Try Again
            </button>
            <button
              type="button"
              class="btn btn-secondary ms-2"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Cancelled Confirmation Modal -->
    <div
      class="modal fade confirmation-modal"
      id="cancelModal"
      tabindex="-1"
      aria-labelledby="cancelModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h5 class="modal-title w-100" id="cancelModalLabel">
              <i class="fas fa-pause-circle error-icon"></i>
              <br />Payment Cancelled
            </h5>
          </div>
          <div class="modal-body text-center">
            <p>Your payment session has been cancelled.</p>
            <p>You can proceed with booking anytime before the event.</p>
          </div>
          <div class="modal-footer justify-content-center">
            <button
              type="button"
              class="btn btn-success"
              data-bs-dismiss="modal"
            >
              Proceed to Booking
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="text-center">
      <div class="container">
        <p class="mb-2">
          &copy; 2025 Sunset DJ Party | Hosted at Jamuna Dighi Resort
        </p>
        <p class="mb-0">
          <small
            >Designed by Bengal IT Solution |
            <a href="tel:+917318749498" style="color: #ffd700"
              >Contact: +91 7318749498</a
            ></small
          >
        </p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
      // Wait for DOM to load before initializing
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize EmailJS with your public key (updated for v4)
        emailjs.init({
          publicKey: "yRrP06nzUq5w_mZb6", // Explicit publicKey for v4
        });
        console.log("EmailJS initialized successfully"); // Debug log

        // Initialize AOS
        AOS.init({ duration: 800, once: true });

        // Initialize Bootstrap Modals
        const successModal = new bootstrap.Modal(
          document.getElementById("successModal")
        );
        const errorModal = new bootstrap.Modal(
          document.getElementById("errorModal")
        );
        const cancelModal = new bootstrap.Modal(
          document.getElementById("cancelModal")
        );

        // Updated sendBookingConfirmation function with enhanced logging & error handling
        function sendBookingConfirmation(
          userEmail,
          userName,
          userMessage,
          ticketType
        ) {
          console.log("Starting email send process..."); // Debug: Function called
          console.log("Params:", {
            userEmail,
            userName,
            userMessage,
            ticketType,
          }); // Debug: Check params

          // Generate random 6-digit ticket number
          const ticketNumber = Math.floor(
            100000 + Math.random() * 900000
          ).toString();
          console.log("Generated ticket number:", ticketNumber); // Debug: Ticket gen

          // Prepare params for your template 'hdq4gxd'
          const templateParams = {
            to_email: userEmail, // Recipient's email
            name: userName, // e.g., "Alice Smith" (replaces {{name}})
            message: userMessage || "Enjoy the party!", // Custom message
            ticket_type: ticketType || "General Admission", // e.g., "VIP" (replaces {{ticket_type}})
            ticket_number: ticketNumber, // Randomly generated (replaces {{ticket_number}})
          };
          console.log("Template params prepared:", templateParams); // Debug: Params ready

          // Send via your template ID 'hdq4gxd' and service ID
          emailjs
            .send("service_h9dk6h8", "template_tqkwavq", templateParams)
            .then((response) => {
              console.log(
                "Email sent successfully!",
                response.status,
                response.text
              );
              alert("Email sent successfully! Check your inbox."); // User feedback
            })
            .catch((error) => {
              console.error("Failed to send email:", error); // Enhanced error log
              console.error("Full error details:", error.text || error); // More details
              alert(
                "Email failed to send. Check console for details or contact support."
              ); // User alert
            });

          // Return ticketNumber for use in modal (optional)
          return ticketNumber;
        }

        // Countdown Timer
        function updateCountdown() {
          const eventDate = new Date("October 18, 2025 11:00:00").getTime();
          const now = Date.now();
          const diff = eventDate - now;

          if (diff <= 0) {
            document.getElementById("countdown").innerHTML =
              "ðŸŽ‰ Event is Live! ðŸŽ‰";
            return;
          }

          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
          const minutes = Math.floor((diff / (1000 * 60)) % 60);
          const seconds = Math.floor((diff / 1000) % 60);

          document.getElementById(
            "countdown"
          ).innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s to Start`;
        }
        setInterval(updateCountdown, 1000);
        updateCountdown();

        // Clickable Location with GPS
        document
          .getElementById("locationLink")
          .addEventListener("click", function (e) {
            e.preventDefault();

            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(
                function (position) {
                  const lat = position.coords.latitude;
                  const lon = position.coords.longitude;
                  // Open Google Maps with directions from current location to Jamuna Dighi
                  window.open(
                    `https://www.google.com/maps/dir/${lat},${lon}/Jamuna+Dighi+Resort+713403`,
                    "_blank"
                  );
                },
                function (error) {
                  // If location access denied, open direct location
                  window.open(
                    "https://goo.gl/maps/8W6kA8TrvEkvb4xE7",
                    "_blank"
                  );
                }
              );
            } else {
              // If geolocation not supported, open direct location
              window.open("https://goo.gl/maps/8W6kA8TrvEkvb4xE7", "_blank");
            }
          });

        // Booking Form Submission with Razorpay (Enhanced for Security & UX)
        document
          .getElementById("bookingForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();
            console.log("Form submitted"); // Debug: Form trigger

            const name = document.getElementById("name").value.trim();
            const email = document.getElementById("email").value.trim();
            const phone = document.getElementById("phone").value.trim();
            const entryType = document.getElementById("entryType").value;

            console.log("Form data:", { name, email, phone, entryType }); // Debug: Form data

            if (!name || !email || !phone || !entryType) {
              // Use modal for validation error instead of alert
              errorModal._element.querySelector(".modal-body").innerHTML =
                '<p class="text-danger">Please fill all fields correctly!</p><p>You can try again without losing your data.</p>';
              errorModal.show();
              return;
            }

            const amount = entryType === "couple" ? 2199 : 1299;
            const entryLabel =
              entryType === "couple" ? "Couple Entry" : "Stag Entry";
            console.log("Amount & Label:", { amount, entryLabel }); // Debug: Payment details

            // For enhanced security: In production, move Razorpay key to server-side or use environment vars.
            // Here, we're using test key; replace with live key for production.
            // Additionally, verify payment on your backend using Razorpay's webhook or API.

            // Razorpay options with improved handlers
            const options = {
              key: "rzp_test_Uo4w2pSpf6gxMv", // ðŸ”‘ Replace with your Razorpay live key for production
              amount: amount * 100, // Amount in paise
              currency: "INR",
              name: "Sunset DJ Party",
              description: `${entryLabel} - Diwali 2025`,
              image: "https://via.placeholder.com/150", // Optional: Add your logo URL
              handler: function (response) {
                console.log("Razorpay payment success:", response); // Debug: Payment success
                // NEW: Generate ticket and send email using the function
                const ticketNumber = sendBookingConfirmation(
                  email, // userEmail
                  name, // userName
                  "Your spot is secured for an epic Diwali night!", // userMessage (customize as needed)
                  entryLabel // ticketType (e.g., "Couple Entry")
                );

                // Payment successful - Show details in modal (now includes ticket number)
                document.getElementById("successDetails").innerHTML = `
              <div class="alert alert-success" role="alert">
                <strong>Booking Details:</strong><br>
                Name: ${name}<br>
                Entry: ${entryLabel}<br>
                Amount: â‚¹${amount}<br>
                Ticket #: ${ticketNumber}<br>
                Payment ID: ${response.razorpay_payment_id}<br>
                Order ID: ${response.razorpay_order_id}
              </div>
            `;
                successModal.show();

                // Reset form after success
                document.getElementById("bookingForm").reset();
              },
              prefill: {
                name: name,
                email: email,
                contact: phone,
              },
              theme: {
                color: "#e74c3c",
              },
              modal: {
                ondismiss: function () {
                  console.log("Razorpay dismissed"); // Debug: Dismiss
                  cancelModal.show();
                },
                // Handle payment errors (e.g., network issues)
                onerror: function () {
                  console.log("Razorpay error"); // Debug: Error
                  errorModal.show();
                },
              },
            };

            const rzp = new Razorpay(options);
            rzp.open();
          });

        // Event listeners for modals
        document
          .getElementById("successModal")
          .addEventListener("hidden.bs.modal", function () {
            // Optional: Scroll to top or redirect after close
            window.scrollTo({ top: 0, behavior: "smooth" });
          });

        document
          .getElementById("errorModal")
          .addEventListener("hidden.bs.modal", function () {
            // Focus back to form for retry
            document
              .getElementById("bookingForm")
              .scrollIntoView({ behavior: "smooth" });
          });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute("href"));
            if (target) {
              target.scrollIntoView({ behavior: "smooth", block: "start" });
            }
          });
        });
      });
    </script>
  </body>
</html>
